---
# Feel free to add content and custom Front Matter to this file.
# To modify the layout, see https://jekyllrb.com/docs/themes/#overriding-theme-defaults

layout: default
---
<div class="container">
    <button onclick="captureImage()">拍照</button>
    <div id="message">

    </div>
</div>
<script>
    showMessage("238749328759834275902934759832749587234987592394875989027349579324087598238947598137459073249057932408759023475093234790573240957923048")
    document.addEventListener("plusready", onPlusReady, false);
    function showMessage(msg) {
        var messageBlock = document.getElementById("message");
        var par = document.createElement("p")
        par.innerText = msg
        messageBlock.appendChild(par)
        return
    }
    function onPlusReady() {
        showMessage("plusready");
    }
    function captureImage() {
        var cmr = plus.camera.getCamera();
        var res = cmr.supportedImageResolutions[0];
        var fmt = cmr.supportedImageFormats[0];
        showMessage("Resolution: " + res + ", Format: " + fmt);
        cmr.captureImage(function (path) {
            showMessage("Capture image success: " + path);
            plus.io.resolveLocalFileSystemURL(path, function (entry) {
                showMessage(entry.toLocalURL())
                entry.file(function (file) {
                    var fileReader = new plus.io.FileReader();
                    showMessage("getFile:" + JSON.stringify(file))
                    fileReader.onloadend = function (evt) {
                        showMessage(evt.target.result)
                    }
                    fileReader.readAsDataURL(file, 'utf-8');
                })
            }, function (error) {
                showMessage(JSON.stringify(error))
            });
        },
            function (error) {
                showMessage("Capture image failed: " + error.message);
            },
            { resolution: res, format: fmt }
        );
    }

    function compressImage(url, filename, divid) {
        var name = "_doc/upload/" + divid + "-" + filename;//_doc/upload/F_ZDDZZ-1467602809090.jpg
        plus.zip.compressImage({
            src: url,//src: (String 类型 )压缩转换原始图片的路径
            dst: name,//压缩转换目标图片的路径
            quality: 20,//quality: (Number 类型 )压缩图片的质量.取值范围为1-100
            overwrite: true//overwrite: (Boolean 类型 )覆盖生成新文件
        },
            function (event) {
                saveimage(event.target, divid, filename, path);
            }, function (error) {
                plus.nativeUI.toast("压缩图片失败，请稍候再试");
            });
    }
</script>